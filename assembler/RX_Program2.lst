               ;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^;
               ;    Author    : Chanartip Soonthornwan                     ;
               ;    Student_ID: 014353883                                  ;
               ;    Email     : Chanartip.Soonthornwan@gmail.com           ;
               ;    Subject   : CECS460                                    ;
               ;    Instructor: John Tramel                                ;
               ;    Assignment: Project Three Receive Engine               ;
               ;                                                           ;
               ;    Current Version: 1.0                                   ;
               ;    Date      : April 16, 2018                             ;
               ;                                                           ;
               ;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^;
               
               ;=============================================================
               ; Data Constants
               ;=============================================================
               ZEROS           EQU     0000
               ONE             EQU     0001
               TWO             EQU     0002
               THREE           EQU     0003
               FOUR            EQU     0004
               MAX_CHAR        EQU     0028
               
               ;=============================================================
               ; ScratchPad alias
               ;=============================================================
               BANNER_BEGIN	EQU		0000
               BANNER_END		EQU		0097
               PROMPT_BEGIN    EQU	    0097
               PROMPT_END      EQU		00B3
               HOMETOWN_BEGIN  EQU		00B3
               HOMETOWN_END	EQU		00CB
               CRLF_BEGIN		EQU		00CB
               CRLF_END		EQU		00CD
               ;=============================================================
               ; Register alias
               ;=============================================================
               TEMP_REG        EQU     R1
               COUNT           EQU     R2
               INDEX           EQU     R3
               LED             EQU     R4
               DELAY           EQU     R5
               DELAY2          EQU     R6
               PRINT_FLAG      EQU     R7
               ECHO_END        EQU     R8
               UART_STATUS     EQU     R9
               CHAR_COUNT      EQU     RA
               
               ;=============================================================
               ; Port alias
               ;=============================================================
               DATA_PORT       EQU     0000
               STATUS_PORT     EQU     0001
               LED_PORT        EQU     0002
               
               ;=============================================================
               ; ASCII in uses
               ;=============================================================
               ASC_NULL   EQU   0000  ; NULL
               ASC_BS     EQU   0008  ; Back Space
               ASC_TAB    EQU   0009  ; Horizontal Tab
               ASC_LF     EQU   000A  ; <LF> Line Feed (new line)
               ASC_CR     EQU   000D  ; <CR> Carriage return
               ASC_STAR   EQU   002A  ; '*'  star
               ASC_AT     EQU   0040  ; '@'  at
               ASC_DOT    EQU   002E  ; '.'  dot
               ASC_SL     EQU   002F  ; '/'  slash
               ASC_EQ     EQU   003D  ; '='  equal sign
               ASC_DASH   EQU   002D  ; '-'  dash
               ASC_SP     EQU   0020  ; ' '  space
               ASC_LB     EQU   005B  ; '['  Left Bracket
               ASC_RB     EQU   005D  ; '];  Right Bracket
               ASC_0      EQU   0030
               ASC_1      EQU   0031
               ASC_2      EQU   0032
               ASC_3      EQU   0033
               ASC_4      EQU   0034
               ASC_5      EQU   0035
               ASC_6      EQU   0036
               ASC_7      EQU   0037
               ASC_8      EQU   0038
               ASC_9      EQU   0039
               ASC_A      EQU   0041
               ASC_B      EQU   0042
               ASC_C      EQU   0043
               ASC_D      EQU   0044
               ASC_E      EQU   0045
               ASC_F      EQU   0046
               ASC_G      EQU   0047
               ASC_H      EQU   0048
               ASC_I      EQU   0049
               ASC_J      EQU   004A
               ASC_K      EQU   004B
               ASC_L      EQU   004C
               ASC_M      EQU   004D
               ASC_N      EQU   004E
               ASC_O      EQU   004F
               ASC_P      EQU   0050
               ASC_Q      EQU   0051
               ASC_R      EQU   0052
               ASC_S      EQU   0053
               ASC_T      EQU   0054
               ASC_U      EQU   0055
               ASC_V      EQU   0056
               ASC_W      EQU   0057
               ASC_X      EQU   0058
               ASC_Y      EQU   0059
               ASC_Z      EQU   005A
               
               ;=============================================================
               ; Startup: Initialize the design at reset
               ;
               ;=============================================================
               			ADDRESS 0000
               INIT
               ; Initialize registers
                           LOAD    TEMP_REG, ZEROS
0000 AE01 0000
                           LOAD    COUNT, ZEROS
0002 AE02 0000
                           LOAD    INDEX, ZEROS
0004 AE03 0000
                           LOAD    LED, ZEROS
0006 AE04 0000
                           LOAD    PRINT_FLAG, FOUR
0008 AE07 0004
                           LOAD    UART_STATUS, ZEROS
000A AE09 0000
                           LOAD    CHAR_COUNT, ZEROS
000C AE0A 0000
               
                           CALL    BANNER_INIT
000E 8E00 0030
                           CALL    PROMPT_INIT
0010 8E00 0160
                           CALL    HOMETOWN_INIT
0012 8E00 01f4
               			
                           LOAD    TEMP_REG, ASC_CR
0014 AE01 000D
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0017 8203 0001
                           LOAD    TEMP_REG, ASC_LF
0019 AE01 000A
                           STORE   TEMP_REG, INDEX
7631
                           AND     INDEX, ZEROS ; Reset to ZEROS to be ready to display
001C 8A03 0000
               			
               START       ENINT
001E 1E00               
               ; Main Loop
               MAIN
                           CALL    BLINK_LED
001F 8E00 0280
                           JUMP    MAIN
0021 A400 001f
               
               ;=============================================================
               ; Subroutine: BANNER_INIT
               ;       Displaying a banner with a prompt upon reset
               ;
               ;   Store a Banner to ScratchPad Memory
               ;   //////////////////////////////////////////////////
               ;       CECS460 PROJECT3
               ;       By  CHANARTIP SOONTHORNWAN
               ;   //////////////////////////////////////////////////
               ;
               ;   by incrementing the memory pointer each time storing a character
               ;   then reset the index to ZEROS for the next use in main program.
               ;
               ;   input registers: none
               ;   output registers: none
               ;=============================================================
                           ADDRESS 0030
               BANNER_INIT
                           LOAD    TEMP_REG, ASC_SL
0030 AE01 002F
               SL_50       STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0033 8203 0001
                           ADD     COUNT, ONE
0035 8202 0001
                           COMP    COUNT, 0031         ; if count < 0d50
0037 9802 0031
                           JUMPC   SL_50
0039 A600 0032
                           LOAD    COUNT, ZEROS
003B AE02 0000
               
                           COMP    INDEX, 0064         ; if index > 0d100
003D 9803 0064
                           JUMPNC  DONE_BANNER
003F A800 0144
               
                           LOAD    TEMP_REG, ASC_CR
0041 AE01 000D
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0044 8203 0001
                           LOAD    TEMP_REG, ASC_LF
0046 AE01 000A
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0049 8203 0001
               
                           LOAD    TEMP_REG, ASC_TAB
004B AE01 0009
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
004E 8203 0001
                           LOAD    TEMP_REG, ASC_C
0050 AE01 0043
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0053 8203 0001
                           LOAD    TEMP_REG, ASC_E
0055 AE01 0045
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0058 8203 0001
                           LOAD    TEMP_REG, ASC_C
005A AE01 0043
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
005D 8203 0001
                           LOAD    TEMP_REG, ASC_S
005F AE01 0053
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0062 8203 0001
                           LOAD    TEMP_REG, ASC_4
0064 AE01 0034
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0067 8203 0001
                           LOAD    TEMP_REG, ASC_6
0069 AE01 0036
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
006C 8203 0001
                           LOAD    TEMP_REG, ASC_0
006E AE01 0030
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0071 8203 0001
                           LOAD    TEMP_REG, ASC_SP
0073 AE01 0020
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0076 8203 0001
                           LOAD    TEMP_REG, ASC_P
0078 AE01 0050
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
007B 8203 0001
                           LOAD    TEMP_REG, ASC_R
007D AE01 0052
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0080 8203 0001
                           LOAD    TEMP_REG, ASC_O
0082 AE01 004F
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0085 8203 0001
                           LOAD    TEMP_REG, ASC_J
0087 AE01 004A
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
008A 8203 0001
                           LOAD    TEMP_REG, ASC_E
008C AE01 0045
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
008F 8203 0001
                           LOAD    TEMP_REG, ASC_C
0091 AE01 0043
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0094 8203 0001
                           LOAD    TEMP_REG, ASC_T
0096 AE01 0054
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0099 8203 0001
                           LOAD    TEMP_REG, ASC_3
009B AE01 0033
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
009E 8203 0001
                           LOAD    TEMP_REG, ASC_CR
00A0 AE01 000D
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00A3 8203 0001
                           LOAD    TEMP_REG, ASC_LF
00A5 AE01 000A
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00A8 8203 0001
                           LOAD    TEMP_REG, ASC_TAB
00AA AE01 0009
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00AD 8203 0001
                           LOAD    TEMP_REG, ASC_B
00AF AE01 0042
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00B2 8203 0001
                           LOAD    TEMP_REG, ASC_Y
00B4 AE01 0059
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00B7 8203 0001
                           LOAD    TEMP_REG, ASC_CR
00B9 AE01 000D
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00BC 8203 0001
                           LOAD    TEMP_REG, ASC_LF
00BE AE01 000A
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00C1 8203 0001
                           LOAD    TEMP_REG, ASC_TAB
00C3 AE01 0009
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00C6 8203 0001
                           LOAD    TEMP_REG, ASC_C
00C8 AE01 0043
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00CB 8203 0001
                           LOAD    TEMP_REG, ASC_H
00CD AE01 0048
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00D0 8203 0001
                           LOAD    TEMP_REG, ASC_A
00D2 AE01 0041
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00D5 8203 0001
                           LOAD    TEMP_REG, ASC_N
00D7 AE01 004E
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00DA 8203 0001
                           LOAD    TEMP_REG, ASC_A
00DC AE01 0041
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00DF 8203 0001
                           LOAD    TEMP_REG, ASC_R
00E1 AE01 0052
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00E4 8203 0001
                           LOAD    TEMP_REG, ASC_T
00E6 AE01 0054
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00E9 8203 0001
                           LOAD    TEMP_REG, ASC_I
00EB AE01 0049
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00EE 8203 0001
                           LOAD    TEMP_REG, ASC_P
00F0 AE01 0050
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00F3 8203 0001
                           LOAD    TEMP_REG, ASC_SP
00F5 AE01 0020
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00F8 8203 0001
                           LOAD    TEMP_REG, ASC_S
00FA AE01 0053
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
00FD 8203 0001
                           LOAD    TEMP_REG, ASC_O
00FF AE01 004F
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0102 8203 0001
                           LOAD    TEMP_REG, ASC_O
0104 AE01 004F
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0107 8203 0001
                           LOAD    TEMP_REG, ASC_N
0109 AE01 004E
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
010C 8203 0001
                           LOAD    TEMP_REG, ASC_T
010E AE01 0054
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0111 8203 0001
                           LOAD    TEMP_REG, ASC_H
0113 AE01 0048
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0116 8203 0001
                           LOAD    TEMP_REG, ASC_O
0118 AE01 004F
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
011B 8203 0001
                           LOAD    TEMP_REG, ASC_R
011D AE01 0052
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0120 8203 0001
                           LOAD    TEMP_REG, ASC_N
0122 AE01 004E
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0125 8203 0001
                           LOAD    TEMP_REG, ASC_W
0127 AE01 0057
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
012A 8203 0001
                           LOAD    TEMP_REG, ASC_A
012C AE01 0041
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
012F 8203 0001
                           LOAD    TEMP_REG, ASC_N
0131 AE01 004E
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0134 8203 0001
                           LOAD    TEMP_REG, ASC_CR
0136 AE01 000D
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0139 8203 0001
                           LOAD    TEMP_REG, ASC_LF
013B AE01 000A
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
013E 8203 0001
               
                           LOAD    TEMP_REG, ASC_SL
0140 AE01 002F
                           JUMP    SL_50
0142 A400 0032
               
               DONE_BANNER
                           LOAD    TEMP_REG, ASC_CR
0144 AE01 000D
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0147 8203 0001
                           LOAD    TEMP_REG, ASC_LF
0149 AE01 000A
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE          ; should be index for PROMPT BEGIN
014C 8203 0001
               
                           LOAD    COUNT, ZEROS
014E AE02 0000
               
                           RETURN
0150 3A00               
               ;=============================================================
               ; Subroutine:   PROMPT_INIT
               ;   Store a Prompt into the ScratchPad Memory
               ;
               ;   procedure:
               ;       - increment the index each time storing a character
               ;
               ;       PRESS ANY KEY TO CONTINUE...
               ;
               ;       - then reset the index to ZEROS for the next use in main
               ;
               ;   input registers: none
               ;   output registers: none
               ;=============================================================
                           ADDRESS 0160
               
               PROMPT_INIT
                           LOAD    TEMP_REG, ASC_P
0160 AE01 0050
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0163 8203 0001
                           LOAD    TEMP_REG, ASC_R
0165 AE01 0052
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0168 8203 0001
                           LOAD    TEMP_REG, ASC_E
016A AE01 0045
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
016D 8203 0001
                           LOAD    TEMP_REG, ASC_S
016F AE01 0053
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0172 8203 0001
                           LOAD    TEMP_REG, ASC_S
0174 AE01 0053
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0177 8203 0001
                           LOAD    TEMP_REG, ASC_SP
0179 AE01 0020
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
017C 8203 0001
                           LOAD    TEMP_REG, ASC_A
017E AE01 0041
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0181 8203 0001
                           LOAD    TEMP_REG, ASC_N
0183 AE01 004E
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0186 8203 0001
                           LOAD    TEMP_REG, ASC_Y
0188 AE01 0059
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
018B 8203 0001
                           LOAD    TEMP_REG, ASC_SP
018D AE01 0020
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0190 8203 0001
                           LOAD    TEMP_REG, ASC_K
0192 AE01 004B
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0195 8203 0001
                           LOAD    TEMP_REG, ASC_E
0197 AE01 0045
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
019A 8203 0001
                           LOAD    TEMP_REG, ASC_Y
019C AE01 0059
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
019F 8203 0001
                           LOAD    TEMP_REG, ASC_SP
01A1 AE01 0020
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01A4 8203 0001
                           LOAD    TEMP_REG, ASC_T
01A6 AE01 0054
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01A9 8203 0001
                           LOAD    TEMP_REG, ASC_O
01AB AE01 004F
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01AE 8203 0001
                           LOAD    TEMP_REG, ASC_SP
01B0 AE01 0020
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01B3 8203 0001
                           LOAD    TEMP_REG, ASC_C
01B5 AE01 0043
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01B8 8203 0001
                           LOAD    TEMP_REG, ASC_O
01BA AE01 004F
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01BD 8203 0001
                           LOAD    TEMP_REG, ASC_N
01BF AE01 004E
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01C2 8203 0001
                           LOAD    TEMP_REG, ASC_T
01C4 AE01 0054
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01C7 8203 0001
                           LOAD    TEMP_REG, ASC_I
01C9 AE01 0049
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01CC 8203 0001
                           LOAD    TEMP_REG, ASC_N
01CE AE01 004E
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01D1 8203 0001
                           LOAD    TEMP_REG, ASC_U
01D3 AE01 0055
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01D6 8203 0001
                           LOAD    TEMP_REG, ASC_E
01D8 AE01 0045
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01DB 8203 0001
                           LOAD    TEMP_REG, ASC_DOT
01DD AE01 002E
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01E0 8203 0001
                           LOAD    TEMP_REG, ASC_DOT
01E2 AE01 002E
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01E5 8203 0001
                           LOAD    TEMP_REG, ASC_DOT
01E7 AE01 002E
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE          ; This INDEX should be HOMETOWN_BEGIN
01EA 8203 0001
               
                           RETURN
01EC 3A00               
               ;=============================================================
               ; Sub Routine: HOMETOWN_INIT
               ;       Store "MY HOMETOWN IS BANGKOK"
               ;
               ;=============================================================
                           ADDRESS 01F4
               
               HOMETOWN_INIT
                           LOAD    TEMP_REG, ASC_M
01F4 AE01 004D
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01F7 8203 0001
                           LOAD    TEMP_REG, ASC_Y
01F9 AE01 0059
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
01FC 8203 0001
                           LOAD    TEMP_REG, ASC_SP
01FE AE01 0020
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0201 8203 0001
                           LOAD    TEMP_REG, ASC_H
0203 AE01 0048
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0206 8203 0001
                           LOAD    TEMP_REG, ASC_O
0208 AE01 004F
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
020B 8203 0001
                           LOAD    TEMP_REG, ASC_M
020D AE01 004D
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0210 8203 0001
                           LOAD    TEMP_REG, ASC_E
0212 AE01 0045
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0215 8203 0001
                           LOAD    TEMP_REG, ASC_T
0217 AE01 0054
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
021A 8203 0001
                           LOAD    TEMP_REG, ASC_O
021C AE01 004F
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
021F 8203 0001
                           LOAD    TEMP_REG, ASC_W
0221 AE01 0057
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0224 8203 0001
                           LOAD    TEMP_REG, ASC_N
0226 AE01 004E
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0229 8203 0001
                           LOAD    TEMP_REG, ASC_SP
022B AE01 0020
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
022E 8203 0001
                           LOAD    TEMP_REG, ASC_I
0230 AE01 0049
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0233 8203 0001
                           LOAD    TEMP_REG, ASC_S
0235 AE01 0053
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0238 8203 0001
                           LOAD    TEMP_REG, ASC_SP
023A AE01 0020
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
023D 8203 0001
                           LOAD    TEMP_REG, ASC_B
023F AE01 0042
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0242 8203 0001
                           LOAD    TEMP_REG, ASC_A
0244 AE01 0041
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0247 8203 0001
                           LOAD    TEMP_REG, ASC_N
0249 AE01 004E
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
024C 8203 0001
                           LOAD    TEMP_REG, ASC_G
024E AE01 0047
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0251 8203 0001
                           LOAD    TEMP_REG, ASC_K
0253 AE01 004B
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0256 8203 0001
                           LOAD    TEMP_REG, ASC_O
0258 AE01 004F
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
025B 8203 0001
                           LOAD    TEMP_REG, ASC_K
025D AE01 004B
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0260 8203 0001
               			LOAD    TEMP_REG, ASC_CR
0262 AE01 000D
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE
0265 8203 0001
                           LOAD    TEMP_REG, ASC_LF
0267 AE01 000A
                           STORE   TEMP_REG, INDEX
7631
                           ADD     INDEX, ONE	  ; This INDEX should be CRLF_BEGIN
026A 8203 0001
               			
                           RETURN
026C 3A00               
               ;=============================================================
               ; Subroutine: BLINK_LED
               ;       Blinking LEDs while idling the main loop
               ;
               ;   Procedure:
               ;       - Decrementing counters each time the routine is called.
               ;       0xFFFF * 0x0019 provides 60HZ for LED to visibly blinking.
               ;       - Once the both counter reach zeros, assigning new LED
               ;       values and then outputs the value through LED_PORT(0002).
               ;
               ;   input registers: none
               ;   output registers: none
               ;=============================================================
                           ADDRESS 0280
               BLINK_LED
                           LOAD    DELAY, FFFF
0280 AE05 FFFF
                           LOAD    DELAY2, 0019
0282 AE06 0019
               TAG
                           SUB     DELAY, ONE
0284 DC05 0001
                           JUMPNZ  TAG
0286 AC00 0284
                           LOAD    DELAY, FFFF
0288 AE05 FFFF
                           SUB     DELAY2, ONE
028A DC06 0001
                           JUMPNZ  TAG
028C AC00 0284
               
                           XOR     LED, 00FF
028E E804 00FF
                           OUTPUT  LED, LED_PORT
0290 B804 0002
                           RETURN
0292 3A00               
               ;=============================================================
               ;   Subroutine: TX_FUNC
               ;
               ;   case(PRINT_FLAG)
               ;       BANNER:      PRINT_BANNER();
               ;       PROMPT:      PRINT_PROMPT();
               ;       HOMETOWN:    PRINT_HOMETOWN();
               ;       default:     PRINT_ECHO();
               ;   endcase
               ;
               ;=============================================================
                           ADDRESS 02A0
               TX_FUNC
               			COMP 	PRINT_FLAG, ZEROS
02A0 9807 0000
               			RETURNZ
02A2 4000               			
                           FETCH   TEMP_REG, INDEX
7231
                           OUTPUT  TEMP_REG, DATA_PORT
02A4 B801 0000
                           ADD     INDEX, ONE
02A6 8203 0001
               
                           COMP    PRINT_FLAG, FOUR
02A8 9807 0004
                           JUMPZ   DISPLAY_BANNER
02AA AA00 02b9
                           COMP    PRINT_FLAG, THREE
02AC 9807 0003
                           JUMPZ   DISPLAY_PROMPT
02AE AA00 02bf
                           COMP    PRINT_FLAG, TWO
02B0 9807 0002
                           JUMPZ   DISPLAY_HOMETOWN
02B2 AA00 02c5
                           COMP    PRINT_FLAG, ONE
02B4 9807 0001
                           JUMPZ   DISPLAY_CRLF
02B6 AA00 02cd
               
                           RETURN
02B8 3A00               
               DISPLAY_BANNER
                           COMP    INDEX, BANNER_END
02B9 9803 0097
                           RETURNC
02BB 3C00                           LOAD    PRINT_FLAG, THREE
02BC AE07 0003
                           RETURN
02BE 3A00               			
               DISPLAY_PROMPT
                           COMP    INDEX, PROMPT_END
02BF 9803 00B3
                           RETURNC
02C1 3C00                           LOAD    PRINT_FLAG, ZEROS
02C2 AE07 0000
                           RETURN
02C4 3A00               			
               DISPLAY_HOMETOWN
                           COMP    INDEX, HOMETOWN_END
02C5 9803 00CB
                           RETURNC
02C7 3C00               			LOAD	INDEX, PROMPT_BEGIN
02C8 AE03 0097
                           LOAD    PRINT_FLAG, THREE
02CA AE07 0003
                           RETURN
02CC 3A00               			
               DISPLAY_CRLF
                           COMP    INDEX, CRLF_END
02CD 9803 00CD
                           RETURNC
02CF 3C00               			LOAD	INDEX, PROMPT_BEGIN
02D0 AE03 0097
                           LOAD    PRINT_FLAG, THREE
02D2 AE07 0003
                           RETURN
02D4 3A00               
               ;=============================================================
               ;   Subroutine: RX_FUNC
               ;
               ;
               ;
               ;=============================================================
                           ADDRESS 0300
               RX_FUNC		
                           COMP    PRINT_FLAG, ZEROS
0300 9807 0000
                           RETURNNZ
0302 4200               
                           INPUT   TEMP_REG, DATA_PORT
0303 A201 0000
               			COMP	TEMP_REG, ZEROS
0305 9801 0000
               			RETURNZ
0307 4000               			
                           COMP    TEMP_REG, ASC_STAR
0308 9801 002A
                           JUMPZ   SET_HOMETOWN
030A AA00 0319
               
               			COMP	TEMP_REG, ASC_CR
030C 9801 000D
               			JUMPZ	SET_CRLF
030E AA00 0324
               			
               			
               			COMP	COUNT, MAX_CHAR
0310 9802 0028
               			JUMPZ	SET_CRLF
0312 AA00 0324
               			ADD		COUNT, ONE
0314 8202 0001
               			OUTPUT	TEMP_REG, DATA_PORT
0316 B801 0000
               			
                           RETURN
0318 3A00               
               
               SET_HOMETOWN
                           LOAD    PRINT_FLAG, TWO
0319 AE07 0002
                           LOAD    INDEX, HOMETOWN_BEGIN
031B AE03 00B3
               			LOAD	TEMP_REG, ASC_NULL
031D AE01 0000
               			OUTPUT	TEMP_REG, DATA_PORT
031F B801 0000
               			LOAD	COUNT, ZEROS
0321 AE02 0000
                           RETURN
0323 3A00               
               SET_CRLF		
               			LOAD	PRINT_FLAG, ONE
0324 AE07 0001
               			LOAD	INDEX, CRLF_BEGIN
0326 AE03 00CB
               			LOAD	TEMP_REG, ASC_NULL
0328 AE01 0000
               			OUTPUT	TEMP_REG, DATA_PORT
032A B801 0000
               			LOAD	COUNT, ZEROS
032C AE02 0000
               			RETURN
032E 3A00               
               ;=============================================================
               ; Sub Routine: Interrupt Service Routine(ISR)
               ;       Checking UART STATUS if the UART is ready to
               ;       transmit or receive a character
               ;       If the Transmit Engine is ready, (UART_STATUS & 0x0002) == 1
               ;       If the Receive Engine is ready, (UART_STATUS & 0x0001) == 1
               ;       Where UART_STATUS is an 8-bit data from UART data
               ;       read from STATUS_PORT(0001)
               ;       UART_STATUS consists
               ;           {3'b0, w_ovf, w_ferr, w_perr, w_txrdy, w_rxrdy};
               ;       which ovf    - overflow flag
               ;             ferr   - framing error
               ;             perr   - parity bit error
               ;           * txrdy  - transmit ready
               ;           * rxrdy  - receive ready
               ;
               ;   Procedure:
               ;       UART_STATUS = INPUT[STATUS_PORT];
               ;       if(UART_STATUS&0x0001==1)
               ;           READ_DATA_FUNC();
               ;       else if(UART_STATUS&0x0002==1)
               ;           PRINT_DATA_FUNC();
               ;       else{
               ;           if(INIT == TWO) DISPLAY_BANNER(); else
               ;           if(INIT == ONE) DISPLAY_PROMPT();
               ;           else INIT = 0;
               ;       }
               ;
               ;   input registers: none
               ;       UART_STATUS - Reading the current UART status from UART;
               ;                     then store it for if-statement.
               ;   output registers: none
               ;
               ;=============================================================
                           ADDRESS 0E00
               ISR
                           INPUT   UART_STATUS, STATUS_PORT
0E00 A209 0001
                           AND     UART_STATUS, THREE          ; check TX_rdy & RX_rdy
0E02 8A09 0003
               
                           COMP    UART_STATUS, THREE
0E04 9809 0003
                           JUMPZ   CALL_BOTH
0E06 AA00 0e11
               			
                           COMP    UART_STATUS, TWO
0E08 9809 0002
                           CALLZ   TX_FUNC                     ; TX is ready
0E0A 9400 02a0
               
                           COMP    UART_STATUS, ONE
0E0C 9809 0001
                           CALLZ   RX_FUNC                     ; RX is ready
0E0E 9400 0300
               
                           RETEN
0E10 4600               
               CALL_BOTH
                           CALL    TX_FUNC                     ; prioritize to TX
0E11 8E00 02a0
                           CALL    RX_FUNC
0E13 8E00 0300
                           RETEN
0E15 4600               
               ;=============================================================
               ;   ISR vectored through 0FFE
               ;   Jump to ISR routine
               ;=============================================================
               
                           ADDRESS 0FFE
               
               ENDIT
                           JUMP ISR
0FFE A400 0e00
               
                           END
               
